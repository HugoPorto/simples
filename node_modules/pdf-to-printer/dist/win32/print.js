"use strict";

const path = require("path");

const fs = require("fs");

const execAsync = require("../execAsync");

const getCommand = (pdf, options) => {
  const ptp = path.join(__dirname, "PDFtoPrinter.exe");
  let command = `${ptp} ${pdf}`;

  if (options.printer) {
    command += ` "${options.printer}"`;
  }

  return command;
};

const print = (pdf, options = {}) => {
  if (!pdf) throw "No PDF specified";
  if (typeof pdf !== "string") throw "Invalid PDF name";
  if (!fs.existsSync(pdf)) throw "No such file";
  const command = getCommand(pdf, options);
  return execAsync(command);
};

module.exports = print;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy93aW4zMi9wcmludC5qcyJdLCJuYW1lcyI6WyJwYXRoIiwicmVxdWlyZSIsImZzIiwiZXhlY0FzeW5jIiwiZ2V0Q29tbWFuZCIsInBkZiIsIm9wdGlvbnMiLCJwdHAiLCJqb2luIiwiX19kaXJuYW1lIiwiY29tbWFuZCIsInByaW50ZXIiLCJwcmludCIsImV4aXN0c1N5bmMiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxNQUFELENBQXBCOztBQUNBLE1BQU1DLEVBQUUsR0FBR0QsT0FBTyxDQUFDLElBQUQsQ0FBbEI7O0FBQ0EsTUFBTUUsU0FBUyxHQUFHRixPQUFPLENBQUMsY0FBRCxDQUF6Qjs7QUFFQSxNQUFNRyxVQUFVLEdBQUcsQ0FBQ0MsR0FBRCxFQUFNQyxPQUFOLEtBQWtCO0FBQ25DLFFBQU1DLEdBQUcsR0FBR1AsSUFBSSxDQUFDUSxJQUFMLENBQVVDLFNBQVYsRUFBcUIsa0JBQXJCLENBQVo7QUFDQSxNQUFJQyxPQUFPLEdBQUksR0FBRUgsR0FBSSxJQUFHRixHQUFJLEVBQTVCOztBQUNBLE1BQUlDLE9BQU8sQ0FBQ0ssT0FBWixFQUFxQjtBQUNuQkQsSUFBQUEsT0FBTyxJQUFLLEtBQUlKLE9BQU8sQ0FBQ0ssT0FBUSxHQUFoQztBQUNEOztBQUNELFNBQU9ELE9BQVA7QUFDRCxDQVBEOztBQVNBLE1BQU1FLEtBQUssR0FBRyxDQUFDUCxHQUFELEVBQU1DLE9BQU8sR0FBRyxFQUFoQixLQUF1QjtBQUNuQyxNQUFJLENBQUNELEdBQUwsRUFBVSxNQUFNLGtCQUFOO0FBQ1YsTUFBSSxPQUFPQSxHQUFQLEtBQWUsUUFBbkIsRUFBNkIsTUFBTSxrQkFBTjtBQUM3QixNQUFJLENBQUNILEVBQUUsQ0FBQ1csVUFBSCxDQUFjUixHQUFkLENBQUwsRUFBeUIsTUFBTSxjQUFOO0FBRXpCLFFBQU1LLE9BQU8sR0FBR04sVUFBVSxDQUFDQyxHQUFELEVBQU1DLE9BQU4sQ0FBMUI7QUFDQSxTQUFPSCxTQUFTLENBQUNPLE9BQUQsQ0FBaEI7QUFDRCxDQVBEOztBQVNBSSxNQUFNLENBQUNDLE9BQVAsR0FBaUJILEtBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmNvbnN0IHBhdGggPSByZXF1aXJlKFwicGF0aFwiKTtcbmNvbnN0IGZzID0gcmVxdWlyZShcImZzXCIpO1xuY29uc3QgZXhlY0FzeW5jID0gcmVxdWlyZShcIi4uL2V4ZWNBc3luY1wiKTtcblxuY29uc3QgZ2V0Q29tbWFuZCA9IChwZGYsIG9wdGlvbnMpID0+IHtcbiAgY29uc3QgcHRwID0gcGF0aC5qb2luKF9fZGlybmFtZSwgXCJQREZ0b1ByaW50ZXIuZXhlXCIpO1xuICBsZXQgY29tbWFuZCA9IGAke3B0cH0gJHtwZGZ9YDtcbiAgaWYgKG9wdGlvbnMucHJpbnRlcikge1xuICAgIGNvbW1hbmQgKz0gYCBcIiR7b3B0aW9ucy5wcmludGVyfVwiYDtcbiAgfVxuICByZXR1cm4gY29tbWFuZDtcbn07XG5cbmNvbnN0IHByaW50ID0gKHBkZiwgb3B0aW9ucyA9IHt9KSA9PiB7XG4gIGlmICghcGRmKSB0aHJvdyBcIk5vIFBERiBzcGVjaWZpZWRcIjtcbiAgaWYgKHR5cGVvZiBwZGYgIT09IFwic3RyaW5nXCIpIHRocm93IFwiSW52YWxpZCBQREYgbmFtZVwiO1xuICBpZiAoIWZzLmV4aXN0c1N5bmMocGRmKSkgdGhyb3cgXCJObyBzdWNoIGZpbGVcIjtcblxuICBjb25zdCBjb21tYW5kID0gZ2V0Q29tbWFuZChwZGYsIG9wdGlvbnMpO1xuICByZXR1cm4gZXhlY0FzeW5jKGNvbW1hbmQpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBwcmludDtcbiJdfQ==